<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{title}</title>
    <!-- Refined typography with primary and secondary fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/card-redesign.css">

    <!-- Libraries -->
    <script src="https://unpkg.com/htmx.org@1.9.6"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.150.1/three.min.js"></script>
    <script src="/js/lib/OrbitControls.nonmodule.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <script src="/js/lib/FontLoader.js"></script>
    <script src="/js/lib/TextGeometry.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.js"></script>
    <script src="/js/terminal.js"></script>
</head>
<body>
<!-- Subtle 3D Canvas Background -->
<canvas id="bg-canvas"></canvas>

<!-- Theme Toggle Button - Refined design -->
<button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
    <svg class="sun" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path d="M12 3a1 1 0 011 1v1a1 1 0 01-2 0V4a1 1 0 011-1zm0 15a1 1 0 011 1v1a1 1 0 01-2 0v-1a1 1 0 011-1zm9-9a1 1 0 01-1 1h-1a1 1 0 010-2h1a1 1 0 011 1zM4 12a1 1 0 01-1 1H2a1 1 0 010-2h1a1 1 0 011 1zm15.7-6.3a1 1 0 01-1.4 0l-.7-.7a1 1 0 011.4-1.4l.7.7a1 1 0 010 1.4zM5.3 18.7a1 1 0 01-1.4 0l-.7-.7a1 1 0 011.4-1.4l.7.7a1 1 0 010 1.4zM5.3 5.3a1 1 0 010-1.4l.7-.7a1 1 0 011.4 1.4l-.7.7a1 1 0 01-1.4 0zm12.8 12.8a1 1 0 010 1.4l-.7.7a1 1 0 11-1.4-1.4l.7-.7a1 1 0 011.4 0zM12 6a6 6 0 100 12 6 6 0 000-12z"/>
    </svg>
    <svg class="moon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
        <path d="M12 3a9 9 0 108.9 7.6 5.4 5.4 0 01-9.8-3.1c0-2.3 1.4-4.2 3.5-5A9 9 0 0012 3z"/>
    </svg>
</button>

<!-- Performance Toggle Button - Refined design -->
<button class="performance-toggle" id="performance-toggle">Disable 3D</button>

<!-- Refined Professional Header -->
<header>
    <h1>Developer Portfolio</h1>
    <nav>
        <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/projects">Projects</a></li>
            <li><a href="/blog">Blog</a></li>
            <li><a href="/contact">Contact</a></li>
        </ul>
    </nav>
</header>

<!-- Main content with refined glass container -->
<main class="glass-container">
    <!-- Terminal container with more professional styling -->
    <div class="terminal-container" id="terminal-container"></div>

    <!-- Content from template -->
    {#if content??}
    {content.safe}
    {/if}

    <!-- Project detail container for HTMX targets -->
    <div id="project-detail" class="glass-morphic"></div>
</main>

<!-- Professional side navigation instead of circular menu -->
<aside class="side-navigation">
    <div class="nav-icon" data-section="home" aria-label="Home">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
        </svg>
    </div>
    <div class="nav-icon" data-section="projects" aria-label="Projects">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
            <polyline points="2 17 12 22 22 17"></polyline>
            <polyline points="2 12 12 17 22 12"></polyline>
        </svg>
    </div>
    <div class="nav-icon" data-section="blog" aria-label="Blog">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
        </svg>
    </div>
    <div class="nav-icon" data-section="contact" aria-label="Contact">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
             stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
            <polyline points="22,6 12,13 2,6"></polyline>
        </svg>
    </div>
</aside>

<!-- Refined Professional Footer -->
<footer>
    <p>Â© 2025 Professional Portfolio</p>
</footer>

<!-- Theme toggle and performance optimization -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
      // Performance toggle
      const performanceToggle = document.getElementById('performance-toggle');
      let effectsDisabled = localStorage.getItem('disable3dEffects') === 'true';

      // Apply saved preference
      if (effectsDisabled) {
        document.body.classList.add('no-3d');
        performanceToggle.textContent = 'Enable 3D';
      }

      performanceToggle.addEventListener('click', function() {
        effectsDisabled = !effectsDisabled;
        localStorage.setItem('disable3dEffects', effectsDisabled);

        if (effectsDisabled) {
          document.body.classList.add('no-3d');
          performanceToggle.textContent = 'Enable 3D';
        } else {
          document.body.classList.remove('no-3d');
          performanceToggle.textContent = 'Disable 3D';
          // Reload to reinitialize 3D elements
          window.location.reload();
        }
      });

      // Theme Toggle
      const themeToggle = document.getElementById('theme-toggle');

      // Check for saved theme preference
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'light') {
        document.body.setAttribute('data-theme', 'light');
      }

      // Theme toggle button
      themeToggle.addEventListener('click', function() {
        if (document.body.getAttribute('data-theme') === 'light') {
          document.body.removeAttribute('data-theme');
          localStorage.setItem('theme', 'dark');
        } else {
          document.body.setAttribute('data-theme', 'light');
          localStorage.setItem('theme', 'light');
        }
      });

      // Smooth scrolling for nav icons
      document.querySelectorAll('.nav-icon').forEach(function(icon) {
        icon.addEventListener('click', function() {
          const sectionId = icon.getAttribute('data-section');
          const target = document.querySelector('section[id="' + sectionId + '"]') ||
                        document.querySelector('#' + sectionId) ||
                        document.querySelector('[data-section="' + sectionId + '"]');

          if (target) {
            window.scrollTo({
              top: target.offsetTop - 100,
              behavior: 'smooth'
            });
          }
        });
      });
    });
</script>

<!-- Load custom scripts -->
<script src="/js/project-models.js"></script>
<script src="/js/3d-background.js"></script>
</body>
</html>